extend type Query {
  authNeedsSetup: SetupStepNeeded
  authTotpUri: String!
}

enum SetupStepNeeded {
  PASSWORD
  TOTP
}

extend type Mutation {
  createAuthToken(password: String!, otp: Int!, expire: Int): AuthToken
  refreshAuthToken(token: String!, expire: Int): AuthToken
  updateAuthPassword(password: String!): Boolean!
  updateAuthTotp(uri: String!, totp: Int!): Boolean!
}

type AuthToken {
  token: String!
  expire: DateTime!
}
