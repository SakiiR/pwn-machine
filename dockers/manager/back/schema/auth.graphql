extend type Query {
  authSetupNeeded: SetupStep
  authTotpUri: String!
}

enum SetupStep {
  PASSWORD
  TOTP
}

extend type Mutation {
  createAuthToken(password: String!, totp: Int!, expire: Int): AuthToken
  refreshAuthToken(token: String!, expire: Int): AuthToken
  updateAuthPassword(current: String!, new: String!): Boolean!
  updateAuthTotp(uri: String!, totp: Int!): Boolean!
}

type AuthToken {
  token: String!
  expire: DateTime
}
